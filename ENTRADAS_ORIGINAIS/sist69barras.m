% dados de sistema distribuiçao do artigo "Optimal Capacitor Placement on Radial Distribution Systems",
% IEEE Transaction on Power Delivery, Vol.4, No.1, January 1989, Mesut E. Baran  and Felix F. Wu 

% OS DADOS DO SISTEMA 
                                                                                                                
% ############################################################################                                  
%  BASES UTILIZADAS:                                                                                                                                                                                                           
% Sb = 10 kVA e  Vb = 12,66 kV; 
%
% Carga Total P(kW) = 3802,19;  Q(kVAr) = 2694,60                                                                                                               
% ############################################################################                                  

% Dados de Barra
% BARRA      TIPO      GBT       VOLT      ANGLE                                           PLOAD(KW)   QLOAD(KVAr)   QBAR    
DBAR=[
    1         3         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       0
    2         1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    3         1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    4         1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    5         1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    6         1         1         1         0         0         0       -999.9    9999.9     2.6       2.2           0       1
    7         1         1         1         0         0         0       -999.9    9999.9     40.4      30.0          0       1
    8         1         1         1         0         0         0       -999.9    9999.9     75.0      54.0          0       1
    9         1         1         1         0         0         0       -999.9    9999.9     30.0      22.0          0       1
    10        1         1         1         0         0         0       -999.9    9999.9     28.0      19.0          0       1
    11        1         1         1         0         0         0       -999.9    9999.9    145.0     104.0          0       1
    12        1         1         1         0         0         0       -999.9    9999.9    145.0     104.0          0       1  
    13        1         1         1         0         0         0       -999.9    9999.9     8.0       5.5           0       1
    14        1         1         1         0         0         0       -999.9    9999.9     8.0       5.5           0       1
    15        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    16        1         1         1         0         0         0       -999.9    9999.9     45.5      30.0          0       1
    17        1         1         1         0         0         0       -999.9    9999.9     60.0      35.0          0       1 
    18        1         1         1         0         0         0       -999.9    9999.9     60.0      35.0          0       1 
    19        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1 
    20        1         1         1         0         0         0       -999.9    9999.9     1.0       0.6           0       1
    21        1         1         1         0         0         0       -999.9    9999.9    114.0      81.0          0       1 
    22        1         1         1         0         0         0       -999.9    9999.9     5.3       3.5           0       1
    23        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    24        1         1         1         0         0         0       -999.9    9999.9     28.0      20.0          0       1
    25        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    26        1         1         1         0         0         0       -999.9    9999.9     14.0      10.0          0       1
    27        1         1         1         0         0         0       -999.9    9999.9     14.0      10.0          0       1
    28        1         1         1         0         0         0       -999.9    9999.9     26.0      18.6          0       1
    29        1         1         1         0         0         0       -999.9    9999.9     26.0      18.6          0       1
    30        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    31        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    32        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    33        1         1         1         0         0         0       -999.9    9999.9     14.0      10.0          0       1
    34        1         1         1         0         0         0       -999.9    9999.9     19.5      14.0          0       1
    35        1         1         1         0         0         0       -999.9    9999.9     6.0       4.0           0       1
    36        1         1         1         0         0         0       -999.9    9999.9     26.0     18.55          0       1
    37        1         1         1         0         0         0       -999.9    9999.9     26.0     18.55          0       1
    38        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    39        1         1         1         0         0         0       -999.9    9999.9     24.0      17.0          0       1
    40        1         1         1         0         0         0       -999.9    9999.9     24.0      17.0          0       1
    41        1         1         1         0         0         0       -999.9    9999.9     1.2       1.0           0       1
    42        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    43        1         1         1         0         0         0       -999.9    9999.9     6.0       4.3           0       1
    44        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    45        1         1         1         0         0         0       -999.9    9999.9    39.22      26.3          0       1
    46        1         1         1         0         0         0       -999.9    9999.9    39.22      26.3          0       1
    47        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    48        1         1         1         0         0         0       -999.9    9999.9     79.0      56.4          0       1
    49        1         1         1         0         0         0       -999.9    9999.9    384.7     274.5          0       1
    50        1         1         1         0         0         0       -999.9    9999.9    384.7     274.5          0       1
    51        1         1         1         0         0         0       -999.9    9999.9     40.5      28.3          0       1
    52        1         1         1         0         0         0       -999.9    9999.9     3.6       2.7           0       1
    53        1         1         1         0         0         0       -999.9    9999.9     4.35      3.5           0       1
    54        1         1         1         0         0         0       -999.9    9999.9     26.4      19.0          0       1
    55        1         1         1         0         0         0       -999.9    9999.9     24.0      17.2          0       1
    56        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    57        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    58        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    59        1         1         1         0         0         0       -999.9    9999.9    100.0      72.0          0       1
    60        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1
    61        1         1         1         0         0         0       -999.9    9999.9    1244.0    888.0          0       1 
    62        1         1         1         0         0         0       -999.9    9999.9     32.0      23.0          0       1
    63        1         1         1         0         0         0       -999.9    9999.9     0.0       0.0           0       1  
    64        1         1         1         0         0         0       -999.9    9999.9    227.0     162.0          0       1
    65        1         1         1         0         0         0       -999.9    9999.9     59.0      42.0          0       1
    66        1         1         1         0         0         0       -999.9    9999.9     18.0      13.0          0       1
    67        1         1         1         0         0         0       -999.9    9999.9     18.0      13.0          0       1
    68        1         1         1         0         0         0       -999.9    9999.9     28.0      20.0          0       1
    69        1         1         1         0         0         0       -999.9    9999.9     28.0      20.0          0       1
];
DBAR(:,14) = 1;
DBAR(:,11) = DBAR(:,11) - DBAR(:,12); 
% DBAR(:,12) -> Injeçao de Reativo na barra (+ Capacitor; - Indutor)

% Passando as Cargas de KW para MW
DBAR(:,10) = DBAR(:,10) .* 1e-3;     %Potencia Ativa em MW
DBAR(:,11) = DBAR(:,11) .* 1e-3;     %Potencia Reativa em MVAr


% Dados de Linha
 % DE        PARA     r(Ohms)   X(Ohms)   Bsh(Ohms)
DLIN=[
    1         2      0.00050   0.00120      0         0         0         0         0        900        0         7
    2         3      0.00050   0.00120      0         0         0         0         0        900        0         7
    3         4      0.00150   0.00360      0         0         0         0         0        900        0         7
    4         5      0.02510   0.02940      0         0         0         0         0        900        0         7
    5         6      0.36600   0.18640      0         0         0         0         0        900        0         7
    6         7      0.38110   0.19410      0         0         0         0         0        900        0         7
    7         8      0.09220   0.04700      0         0         0         0         0        900        0         7
    8         9      0.04930   0.02510      0         0         0         0         0        900        0         7
    9        10      0.81900   0.27070      0         0         0         0         0        900        0         7
    10        11     0.18720   0.06190      0         0         0         0         0        900        0         7
    11        12     0.71140   0.23510      0         0         0         0         0        900        0         7
    12        13     1.03000   0.34000      0         0         0         0         0        900        0         7
    13        14     1.04400   0.34500      0         0         0         0         0        900        0         7
    14        15     1.05800   0.34960      0         0         0         0         0        900        0         7
    15        16     0.19660   0.06500      0         0         0         0         0        900        0         7
    16        17     0.37440   0.12380      0         0         0         0         0        900        0         7
    17        18     0.00470   0.00160      0         0         0         0         0        900        0         7
    18        19     0.32760   0.10830      0         0         0         0         0        900        0         7
    19        20     0.21060   0.06960      0         0         0         0         0        900        0         7
    20        21     0.34160   0.11290      0         0         0         0         0        900        0         7
    21        22     0.01400   0.00460      0         0         0         0         0        900        0         7
    22        23     0.15910   0.05260      0         0         0         0         0        900        0         7
    23        24     0.34630   0.11450      0         0         0         0         0        900        0         7
    24        25     0.74880   0.24750      0         0         0         0         0        900        0         7
    25        26     0.30890   0.10210      0         0         0         0         0        900        0         7
    26        27     0.17320   0.05720      0         0         0         0         0        900        0         7
    3         28     0.00440   0.01080      0         0         0         0         0        900        0         7
    28        29     0.06400   0.15650      0         0         0         0         0        900        0         7
    29        30     0.39780   0.13150      0         0         0         0         0        900        0         7
    30        31     0.07020   0.02320      0         0         0         0         0        900        0         7
    31        32     0.35100   0.11600      0         0         0         0         0        900        0         7
    32        33     0.83900   0.28160      0         0         0         0         0        900        0         7
    33        34     1.70800   0.56460      0         0         0         0         0        900        0         7
    34        35     1.47400   0.48730      0         0         0         0         0        900        0         7
    3         36     0.00440   0.01080      0         0         0         0         0        900        0         7
    36        37     0.06400   0.15650      0         0         0         0         0        900        0         7
    37        38     0.10530   0.12300      0         0         0         0         0        900        0         7
    38        39     0.03040   0.03550      0         0         0         0         0        900        0         7
    39        40     0.00180   0.00210      0         0         0         0         0        900        0         7
    40        41     0.72830   0.85090      0         0         0         0         0        900        0         7
    41        42     0.31000   0.36230      0         0         0         0         0        900        0         7
    42        43     0.04100   0.04780      0         0         0         0         0        900        0         7
    43        44     0.00920   0.01160      0         0         0         0         0        900        0         7
    44        45     0.10890   0.13730      0         0         0         0         0        900        0         7
    45        46     0.00090   0.00120      0         0         0         0         0        900        0         7
    4         47     0.00340   0.00840      0         0         0         0         0        900        0         7
    47        48     0.08510   0.20830      0         0         0         0         0        900        0         7
    48        49     0.28980   0.70910      0         0         0         0         0        900        0         7
    49        50     0.08220   0.20110      0         0         0         0         0        900        0         7
    8         51     0.09280   0.04730      0         0         0         0         0        900        0         7
    51        52     0.33190   0.11140      0         0         0         0         0        900        0         7
    9         53     0.17400   0.08860      0         0         0         0         0        900        0         7
    53        54     0.20300   0.10340      0         0         0         0         0        900        0         7
    54        55     0.28420   0.14470      0         0         0         0         0        900        0         7
    55        56     0.28130   0.14330      0         0         0         0         0        900        0         7
    56        57     1.59000   0.53370      0         0         0         0         0        900        0         7
    57        58     0.78370   0.26300      0         0         0         0         0        900        0         7
    58        59     0.30420   0.10060      0         0         0         0         0        900        0         7
    59        60     0.38610   0.11720      0         0         0         0         0        900        0         7
    60        61     0.50750   0.25850      0         0         0         0         0        900        0         7
    61        62     0.09740   0.04960      0         0         0         0         0        900        0         7
    62        63     0.14500   0.07380      0         0         0         0         0        900        0         7
    63        64     0.71050   0.36190      0         0         0         0         0        900        0         7
    64        65     1.04100   0.53020      0         0         0         0         0        900        0         7
    11        66     0.20120   0.06110      0         0         0         0         0        900        0         7
    66        67     0.00470   0.00140      0         0         0         0         0        900        0         7
    12        68     0.73940   0.24440      0         0         0         0         0        900        0         7
    68        69     0.00470   0.00160      0         0         0         0         0        900        0         7
%     11        43     0.50000   0.50000      0         0         0         0         0        900        0         1
%     13        21     0.50000   0.50000      0         0         0         0         0        900        0         1
%     15        46     1.00000   1.00000      0         0         0         0         0        900        0         1
%     50        59     2.00000   2.00000      0         0         0         0         0        900        0         1
%     27        65     1.00000   1.00000      0         0         0         0         0        900        0         1
];


%  passando para pu na base do sistema
 Vb = 12.660;   % (kV)
 PB = 1000*10^-3; % potencia base do sistema (MVA)
 Zb = (Vb^2)/PB;  
 DLIN(:,3) = DLIN(:,3) ./ Zb;
 DLIN(:,4) = DLIN(:,4) ./ Zb;
 DLIN(:,5) = DLIN(:,5) ./ Zb;

% Dados de Geraçao
% Num. Barra     PGmin  PGmax
DGER=[
    1      1   0.0000 5000.0000
];


% Dados de Tensao
%  GBT       Vmin     Vmax
DTEN=[
   1.0000   0.6   1.1 
];


% Dados Gerais do Sistema
%    Vbase   Sbase
%     [kV]    [kVA]
DSIS = [
    12.660     1000
];



% Dados das Unidades Termoelétricas Distribuídas Candidatas
% sgmin  sgmax   deltsg  fpmin  fpmax  cpt_sn  cpl_sm  cpl_fl   deltfp
% [kVA]  [kVA]    [kVA]               [$/kVA] [$/kWh] [$/kWh]
DGDT = [
    100   1500      100   0.75   1.00    2293   0.012    0.63     0.05
];
% Legenda:
% sgmin   -> Capacidade mínima das termelétricas(kVA)
% sgmax   -> Capacidade máxima das termelétricas(kVA)
% deltsg  -> Passo na capacidade das termelétricas(kVA)
% fpmin   -> Fator de potência mínimo das unidades termoelétricas
% fpmax   -> Fator de potência máximo das unidades termoelétricas
% cpt_sn  -> Fator de custo associado ao investimento em termelétricas baseadas em biomassa [$/kVA]
% cpl_sm  -> Custo de operação e manutenção da termelétrica baseada em biomassa [$/kWh]
% cpl_fl  -> Custo de combustível da termelétrica baseada em biomassa [$/kWh]



% Dados das Unidades Eólicas Distribuídas Candidatas
%  pgw     fpw   fcw   cpt_wd   cpl_wm
% [kW]                [$/kVA]  [$/kWh]
DGDW = [
   2000  1.000  10.0     1882     0.01
%    2000  0.875  10.0     1882     0.01
%     700  0.875  18.8     1882     0.01
];
% Legenda:
% pgw    -> Potência nominal das eólicas(kW)
% fpw    -> Fator de potência das eólicas
% fcw    -> Fator de capacidade das eólicas
% cpt_wd -> Fator de custo associado ao investimento em eólicas [$/kVA]
% cpl_wm -> Custo de operação e manutenção do gerador eólico [$/kWh]



% Dados das Unidades Fotovoltaicas Distribuídas Candidatas
%  pgs     fps   fcp   cpt_pv   cpl_pm
% [kW]                [$/kVA]  [$/kWh]
DGDP = [
%    1000    1.0  18.8     4004     0.01
   2000    1.0  21.38     3004     0.01 % Petrolina
%    2000    1.0  19.53     4004     0.01 % São João do Cariri
];
% Legenda:
% pgs    -> Potência nominal das fotovoltaicas(kW)
% fps    -> Fator de potência das fotovoltaicas
% fcp    -> Fator de capacidade das fotovoltaicas
% cpt_pv -> Fator de custo associado ao investimento em fotovoltaicas [$/kVA]
% cpl_pm -> Custo de operação e manutenção do gerador fotovoltaico [$/kWh]



% Dados de Custos Unitários, Fatores de Conversão e de Planejamento
% anos NGD cpl_en  cpl_ei       efd      efl  cpl_en_f  cpl_ei_f  Dcarga(%) D_anos TxJuros
%          [$/MW] [$/ton]  [kg/kWh] [kg/kWh]
DPLA = [
    30   4     59      20       0.9    0.003       110        67          1      5     0.1
];
% Legenda:
% NGD    -> Número máximo de geradores distribuídos
% cpl_en -> Custo da energia comprada da rede, mesmo custo associado às perdas [$/MW]
% cpl_ei -> Custo do crédito de carbono [$/ton]
% efd    -> Fator de emissão associada à energia comprada da rede [kg/kWh]
% efl    -> Fator de emissão associada à unidades a biomassa [kg/kWh]



% Fatores multiplicativos para cada nível
%                 N1      N2           N3      N4
CURVA = [80       95          60       70   %CURVA DO GRUPO 1
         50       80          95       70]; %CURVA DO GRUPO 2
% As curvas dos grupos estão trocadas em relação ao pdf

% Duracao diária do periodo de carregamento para cada nível (horas)
%         N1      N2           N3      N4
DURACAO = [8       10           2       4
           8       10           2       4]; 

% % Tarifa para cada nível ($/kWh)
% %                 N1      N2           N3      N4
% TARIFA  = [0.06       0.06      1.8*0.06       0.06
%            0.06       0.06      1.8*0.06       0.06]; 
